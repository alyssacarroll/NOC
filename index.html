<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>NOC Dashboard</title>
  <style>
    body {
      font-family: Helvetica;
      margin: 30px;
      background-image: linear-gradient(#08577b, #0e2948, #0e2948, #0e2948, #0e2948, #0e2948);
      color: white;
    }

    h1 {
      text-align: center;
      font-size: 40px;
      margin-bottom: 30px;
      text-shadow: 0 4px 10px #736f92;
    }

    .tile-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 20px;
      max-width: 2000px;
      margin: 0 auto;
      margin-bottom: 20px;
    }

    .tile {
      background-image: linear-gradient(to bottom, #3a96b8d7, #337d97d7, #337d97d7, #388ba9d7, #49bee8d7);
      min-height: 200px;
      border: 5px solid transparent;
      border-radius: 10px;
      padding: 30px;
      padding-bottom: 10px;
      font-size: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      /* spacing */
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .tile-title {
      margin: 10px;
      font-size: 3rem;
      font-weight: bold;
      text-shadow: 0 4px 10px #33235273;
    }

    .tile-body {
      font-size: 1.5rem;
      opacity: 0.9;
      vertical-align: middle;
      text-shadow: 0 4px 10px #2a0747a2;
    }

    .tile-status {
      font-size: 1rem;
      padding-top: 30px;
    }

    .tile:hover {
      background-color: #5883a1;
    }

    a {
      text-decoration: none;
      color: inherit;
      display: block;
    }

    .true {
      border-color: #2ecc71;
      box-shadow: 0 0 10px #2ecc71;
      background-color: #2ecc71;
    }

    .bad {
      border-color: #e74c3c;
      box-shadow: 0 0 10px #e74c3c;
      background-color: #e74c3c;
    }

    .false {
      border-color: #f1c40f;
      box-shadow: 0 0 10px #f1c40f;
      background-color: #f1c40f;
    }

    .form-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      color: black;
      padding: 30px;
      border-radius: 10px;
      width: 500px;
      z-index: 999;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    }

    .form-popup h2 {
      margin-top: 0;
      text-align: center;
    }

    .form-popup label {
      display: block;
      margin-top: 15px;
      font-size: 1.1rem;
    }

    .form-popup textarea {
      width: 100%;
      padding: 10px;
      font-size: 1rem;
      margin-top: 5px;
    }

    .form-buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }

    .form-buttons button {
      padding: 10px 20px;
      font-size: 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .form-buttons .submit {
      background-color: #08577b;
      color: white;
    }

    .form-buttons .close {
      background-color: #ccc;
    }

    #message {
      text-align: center;
      font-weight: bold;
      margin-top: 15px;
    }
  </style>
</head>

<body>

  <h1>NOC Dashboard</h1>
  <div class="tile-grid" id="tileGrid"></div>

  <div class="tile-grid">
    <div class="tile" id="01" onclick="openPopup('check01.html')">
      <div class="tile-title">01</div>
      <div class="tile-body">Data Center Walk</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="02" onclick="openPopup('check02.html')">
      <div class="tile-title">02</div>
      <div class="tile-body">Tech Support Email</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="03" onclick="openPopup('check03.html')">
      <div class="tile-title">03</div>
      <div class="tile-body">VPN TAK & WAVE</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="04" onclick="openPopup('check04.html')">
      <div class="tile-title">04</div>
      <div class="tile-body">WUG</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="05" onclick="openPopup('check05.html')">
      <div class="tile-title">05</div>
      <div class="tile-body">TAK Server Federation</div>
      <div class="tile-status">Status: Loading...</div>
    </div>
  </div>

  <!--Row Two-->
  <div class="tile-grid">
    <div class="tile" id="06" onclick="openPopup('check06.html')">
      <div class="tile-title">06</div>
      <div class="tile-body">PTL</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="07" onclick="openPopup('check07.html')">
      <div class="tile-title">07</div>
      <div class="tile-body">Message</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="08" onclick="openPopup('check08.html')">
      <div class="tile-title">08</div>
      <div class="tile-body">Landing Pad Server</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="09" onclick="openPopup('check09.html')">
      <div class="tile-title">09</div>
      <div class="tile-body">DS File</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="10" onclick="openPopup('check10.html')">
      <div class="tile-title">10</div>
      <div class="tile-body">WAVE Server</div>
      <div class="tile-status">Status: Loading...</div>
    </div>
  </div>

  <!--Row Three-->
  <div class="tile-grid">
    <div class="tile" id="11" onclick="openPopup('check11.html')">
      <div class="tile-title">11</div>
      <div class="tile-body">Eaton Dashboard</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="12" onclick="openPopup('check12.html')">
      <div class="tile-title">12</div>
      <div class="tile-body">InControl</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="13" onclick="openPopup('check13.html')">
      <div class="tile-title">13</div>
      <div class="tile-body">Veeam Daily Backup</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="14" onclick="openPopup('check14.html')">
      <div class="tile-title">14</div>
      <div class="tile-body">PTB Server Checks</div>
      <div class="tile-status">Status: Loading...</div>
    </div>

    <div class="tile" id="15" onclick="openPopup('check15.html')">
      <div class="tile-title">15</div>
      <div class="tile-body">IPsec</div>
      <div class="tile-status">Status: Loading...</div>
    </div>
  </div>

  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRVOcAqswtmyk_vtsIiOeBy6zwv_jT4pxx_UOBlcsr-n4cxa0PnFluIvTP_E9yXk3nCB-SLWi_cOSiW/pub?output=csv";
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxuQKu1YOgZvkhwhnOTdqAEnUMFCm7SkKziz6iqAU3YF4eyjHKglIONFgYLkMFo6X6-Tw/exec";

    // Populate tile status from CSV
    fetch(CSV_URL)
      .then(response => response.text())
      .then(data => {
        const rows = data.trim().split("\n").slice(1); // Skip header
        rows.forEach(row => {
          const [checkNum, statusRaw, notes, timestamp] = row.split(",");
          const status = statusRaw?.trim().toLowerCase();
          const tileId = `${checkNum.padStart(2, "0")}`;

          const tile = document.getElementById(tileId);
          if (tile) {
            if (status) tile.classList.add(status);
            const statusDiv = tile.querySelector(".tile-status");
            var statusName = "";
            if (status == "true") statusName = "Complete";
            else if (status == "false") statusName = "Incomplete";
            else if (status == "warning") statusName = "Warning";
            else statusName = "N/A";
            if (statusDiv) statusDiv.textContent = `Status: ${statusName}`;
          }
        });
      })
      .catch(error => {
        console.error("CSV fetch error:", error);
      });

    // Open a form popup (new window)
    function openPopup(formFile) {
      const popup = window.open(formFile, '_blank', 'width=700,height=600');
      if (!popup) {
        alert("Popup blocked! Please allow popups for this site.");
      }
    }
  </script>


  <!-- Popup Form -->
  <div id="form01" class="form-popup">
    <form class="form-container" onsubmit="submitForm(event, 'form01')">
      <h2>Check 01: Data Center Walk</h2>

      <div class="form-content">
        <label><input type="checkbox" name="completed"> Walkthrough Completed</label>
        <label> Comments:
          <textarea name="comments" rows="3" style="width:100%;"></textarea>
        </label>
      </div>

      <div class="form-buttons">
        <button type="submit">Submit</button>
        <button type="button" onclick="closeForm('form01')">Close</button>
      </div>

    </form>
  </div>


</body>

</html>